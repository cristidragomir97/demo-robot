
version: '2.1'

volumes:
    shered-ros-bin:


services:

  roscore:
    build: ./ros
    network_mode: host
    environment: 
        - UDEV=1
        - ROS_MASTER_URI=http://localhost:11311
    volumes:
      - shered-ros-bin:/opt/ros/noetic
    labels:
      io.balena.features.balena-api: '1'
      io.balena.features.supervisor-api: 1
      
  lidar:
    image: cristidragomir97/rplidar:latest
    network_mode: host
    privileged: true
    environment: 
       - UDEV=1
       - ROS_HOSTNAME=lidar
       - ROS_MASTER_URI=http://roscore:11311
    devices:
      - "/dev:/dev"
    volumes:
      - shered-ros-bin:/opt/ros/noetic
    labels:
      io.balena.features.balena-api: '1'
      io.balena.features.supervisor-api: 1

  rosboard:
    image: cristidragomir97/rosboard:latest
    network_mode: host
    environment: 
       - ROS_HOSTNAME=rosboard
       - ROS_MASTER_URI=http://roscore:11311
    volumes:
      - shered-ros-bin:/opt/ros/noetic
    labels:
      io.balena.features.balena-api: '1'
      io.balena.features.supervisor-api: 1

#    build: ./hectorslam
#    network_mode: host
#    environment: 
##      - UDEV=1
 #   devices:
 #     - "/dev:/dev"

  
